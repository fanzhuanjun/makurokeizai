# 第六章　動的計画法とモデルの再帰的表現

[TOC]

ここまでラムゼイモデル，RBCモデル，ニューケインジアン・モデルなどの異時点間の最適化を織り込んた「おりこむ」動学的一般均衡モデルを紹介してきたが，**その解き方としてラグランジュの未定乗数法により連立方程式を導出し，遠い将来に定常状態に至るという仮定の下で解くという方法を採用してきた**．主としてこの方法が最も数学的に簡単であるという理由からだが（方法の比較は6.5節参照），ここで問題となるのはなぜ「遠い将来に定常状態に至る」と仮定してよいかである．**実際，これまで紹介してきた動学的一般均衡モデルにおいてその仮定は妥当であるのだが，それを議論するにはラグランジュの未定乗数法に代えてベルマン方程式という式を用いた最適化手法(動的計画法)を用いる必要がある．**



##  6.1　ベルマン方程式を用いた最適化手法

### 6.1.1　ベルマン方程式

ベルマン方程式とは，以下のような離散時間の動的計画問題
$$
\max _x \sum_{i=0}^\infty \beta^i U(x_{t+i})\\
\text{s.t.}~ s_{i+1}=g(s_{i},x_i),~i \ge t
\tag{6.1}
$$
を解く際に用いる方程式をいう． ここでは $s_t,x_t$ べクトルでなくそれぞれ1 変数とする． $s_t$ が状態変数，$x_t$ がジャンプ変数にあたる．

2章以降これらの用語はすでに用いているが， 改めて整理しておこう． 一般に， 最適化モデルに含まれる変数は内生変数と外生変数に区別でき， 内生変数はさらに状態変数とそれ以外のジャンプ変数に区別できる．

<img src="C:\Users\13631\AppData\Roaming\Typora\typora-user-images\image-20200604153642779.png" alt="image-20200604153642779" style="zoom:55%;" />

状態変数とは，最適化行動しようとする主体が間接的にしかコントロールできないか，あるいは全くコントロールできない変数をいう．状態変数は先決変数とも呼ばれ，前期の状態と行動に基づき先決的に決定される．上記の $s_{t+1}=g(s_t,x_t)$ のように，遷移式により決定されるという特徴がある．ジャンプ変数は状態変数以外の内生変数であり，当期の状態を所与とした最適化行動の結果として決定される．ジャンプ変数は操作変数（control variable）とも呼ばれる．これらに対して，外生変数は内生変数の値を求めるためにあらかじめ何らかの値を与えておく必要のある変数のことであるが，本章で考える動的計画法問題には外生変数は含まれないものとする．この場合，シミュレーションは状態変数の初期値を変えることにより行う．

ここで，価値関数 $V(s_t)$ を
$$
V(s_t)=\max_x \sum_{i=0}^\infty \beta^iU(x_{t+i})
\tag{6.2}
$$
と定義する．**すなわち，価値関数とは動的計画問題の目的関数 $\sum_{i=0}^\infty \beta^iU(x_{t+i})$ のとりうる「可能」最大値を状態変数 $s_t$ の関数として表したものである．**一般に，外生変数が存在しなければ，動的計画問題の目的関数のとりうる最大値は状態変数の初期値のみによって決まる．[^1]（6.2）式は，目的関数が時間について加法的であるため，1期先の価値関数 $V(s_{t+1})=V(g(s_t,x_t))$ を用いて，
$$
V(s_t)=\max_{x_t} \{ U(x_t)+\beta V(g(s_t, x_t)) \}
\tag{6.3}
$$

> 证明：先把（6.2）式拆一期出来，
> $$
> \begin{align}
> V(s_t) &=\max_x \{U(x_t) + \sum_{i=1}^\infty \beta^iU(x_{t+i})\} \\
> &=\max_x \{U(x_t) + \sum_{i=0}^\infty \beta^{i+1}U(x_{t+1+i})\}\\
> &=\max_x \{U(x_t) + V(s_{t+1}) \}
> \end{align}
> $$

と再帰的な【递归】形式に書き直すことができ，これをベルマン方程式という[^2]．**ベルマン方程式は，変数ではなく関数の解とする関数方程式であり，両辺に出てくる関数 $V$ がその解となる関数である**．

> 黑体字的意思是什么？
>
> bellman方程不是关于某个变量的解，而是关于函数的解．而这个解就是函数 $V$．

外生変数が存在しなければ，最適なジャンプ変数 $x_t$ の値は当期の状態 $s_t$ のみによって決まり，そのような関数 $h: S \ni s_t \mapsto x_t \in \R$ を方策関数（policy function）と呼ぶ．つまり，**ジャンプ変数のとる値を状態変数の関数として表したものが方策関数で**[^3]，$\text{argmax}$ という数学記号を用いて[^4]
$$
h(s_t) = \underset{x_t}{\operatorname{argmax}} \{ U(x_t)+\beta V(g(s_t, x_t)) \}
\tag{6.4}
$$
> すなわち，$h(s_t)=x_t$．

と表せる[^5]．方策関数 $h$ は，
$$
V(s_t)= U(h(s_t))+\beta V(g(s_t, h(s_t)))
\tag{6.5}
$$
という関係を満たす．（6.4）式もしくは（6.5）式の関係を用いて関数 $h$ を求めることもできるが，多くの場合，解析的に求めることは不可能であり，それを具体的に求めたい場合には，関数 $h$ を他の関数で近似する必要がある[^6]．

### 6.1.2　ラグランジュの未定乗数法との関係

これまで，（6.1）のような最適化問題に対して，ラグランジュの未定乗数法により最適化の条件を導出してきたが，ベルマン方程式（6.3）を用いても全く同じ式を導出することができる．まず，ベルマン方程式（6.3）の右辺の括弧内のジャンプ変数 $x_t$ による微分がゼロに等しいこと，すなわち
$$
U'(x_t)+\beta V'(g(s_t, x_t))g_x(s_t,x_t)=0
\tag{6.6}
$$
が最適化の一階条件である．次に，包絡線定理（Envelope theorem）と呼ばれる定理から，価値関数 $V(s_t)$ の微分がベルマン方程式（6.3）の右辺の括弧内の $s_t$ による偏微分に等しいこと，すなわち
$$
V'(s_t)=\beta V'(g(s_t,x_t))g_s(s_t,x_t)
\tag{6.7}
$$
が成り立つことが知られている．ただし，$g_x=\frac{\part g}{\part x},~g_s=\frac{\part g}{\part s}$ で，合成関数の微分法を用いている．

【例】最適成長モデルのベルマン方程式とオイラー方程式（2章脚注10）

最適成長もでるのベルマン方程式は，$A_t=1$ とすると
$$
\begin{align}
V(K_t)=\max_{c_t} \{ \ln(C_t)+\beta V(g(K_t, C_t)) \} \tag{6.8} \\
K_{t+1}=g(K_t,C_t)=K_t^\alpha+(1-\delta)K_t-C_t \tag{6.9} \\
\end{align}
$$
と定式化できるが，これに最適化の一階条件（6.6）式と包絡線定理（6.7）式を当てはめると，
$$
\begin{align}
C_t&:~\frac{1}{C_t} - \beta V'(K_{t+1})=0 \tag{6.10} \\ 
K_t&:~ V'(K_t)= \beta V'(K_{t+1})(\alpha K_t^{\alpha-1}+1-\delta) \tag{6.11}
\end{align}
$$
という方程式が得られる．（6.10）式から $V'(K_{t+1})=\frac{1}{\beta C_t}, V'(K_t)=\frac{1}{\beta C_{t-1}}$  であることを利用して，（6.11）式から $V'$ を消去して整理すると，
$$
\frac{C_t}{C_{t-1}}=\beta (\alpha K_t^{\alpha-1}+1-\delta) \tag{6.12}
$$
というオイラー方程式が得られる．これは，2章の（2.42）式に $A_t=1$ を代入し，時間のインデックス $t$ を $t-1$ に置き換えたものと一致する．

### 6.1.3　方策関数（policy function）の求め方

動的計画問題（6.1）の解となる関数 $h:s_t \mapsto x_t$ ，すなわち方策関数を求める方法はいくつか知られているが，そのうち

- 線型写像で近似した方策関数を行列計算により求める方法
- 関数近似した方策関数を（6.5）式の関係を用いて繰り返し計算によって求める方法

の2通りを紹介する．

前者の線型写像で近似した方策関数を行列計算により求める方法を用いると，モデルを行列により再帰的に表現できる．具体的には，以下のような手順で計算する．

---

**モデルの再帰的表現**

1. 最適化の一階条件を求め，モデルを定常状態周りで対数線型近似する．
2. 定常状態周りで対数線型近似したモデルのジャンプ変数に対応する方策関数が，$p$ を実数として

$$
\hat{x}_t=p \hat{s}_t
\tag{6.13}
$$

という関数型をとると仮定して $p$ を求める．ただし，$x^*,s^*$ をそれぞれ定常値として $\hat{x}_t=\ln(x_t)-\ln(x^*)$，$\hat{s}_t=\ln(s_t)-\ln(s^*)$ を意味する．

---

状態変数，ジャンプ変数の一方でもしくは両方がベクトルの場合は，実数 $p$ が行列 $P$ となる[^7]．最適成長モデルの場合のように状態変数とジャンプ変数の両方とも1変数である場合でも，実数 $p$ を具体的に求める際に，行列の固有値「こゆうち」に関する知識を用いたほうが見通しがよい．したがって，この方法の詳細を6.3節（モデルの再帰的表現）で説明する前に6.2節で行列の定義と使い方を紹介する．

後者の関数近似した方策関数を繰り返し計算によって求める方法について，詳しく6.4節（方策関数の関数近似）で説明するが，先に次の6.1.4項で具体例を紹介する．

### 6.1.4　なぜ「遠い将来に定常状態に至る」と仮定してよいかについて考察

２～５章のモデルを解く際，「遠い将来に定常状態に至る」と仮定してラグランジュの未定乗数法により導出した連立方程式を解いた．この仮定は，最適解の存在条件とも関連しており，厳密な議論は本書の想定するラベルを大きく超える．したがって，ここでは１つのれいとして，上記の最適成長モデルのベルマン方程式を満たす方策関数を関数近似を用いて求め，この仮定の妥当性を議論しよう．

6.4節で説明する方法を用いて近似的に求めた方策関数 $C_t=\tilde{h}(K_t)$ を図示すると，図6.1のようになる．このとき，価値関数の近似 $\tilde{V}(K_t)$ は，図6.2のように求める．パラメータは $\alpha=0.3,\beta=0.99,\delta=0.25$ とおいた．

<img src="C:\Users\13631\AppData\Roaming\Typora\typora-user-images\image-20200607105207719.png" alt="image-20200607105207719" style="zoom:50%;"/> <img src="C:\Users\13631\AppData\Roaming\Typora\typora-user-images\image-20200607105145120.png" alt="image-20200607105145120" style="zoom:50%;" /> 

この $\tilde{h}$ を用いて，例えば $K_1=0.5K^*$ という初期値を与えてシミュレーションを行う（$K^*$ は $K_t$ の定常値），すなわち，
$$
C_t=\tilde{h}(K_t)
\tag{6.14}
$$

$$
K_{t+1}=g(K_t,C_t)=K_t^\alpha+(1-\delta)K_t-C_t
\tag{6.15}
$$

という連立方程式を逐次的に解くと，図6.3のようなグラフを描ける．ここで指摘できる重要な点は，あらかじめ遠い将来に定常状態に至ると仮定しなくとも，$t$ が充分経過した後では，$C_t,K_t$ はそれぞれ定常値 $C^*,K^*$ に一致するという結果である．しかも，そこに至るまでの経路は，2章の図2.8に示すのとほぼ同じである．したがって，遠い将来に定常状態に至ると仮定して連立方程式を解くというのは，妥当な方法であったことだ（1つの具体例に過ぎないが）示せた．

<img src="C:\Users\13631\AppData\Roaming\Typora\typora-user-images\image-20200607104959267.png" alt="image-20200607104959267" style="zoom:45%;" />

[^1]: ラムゼイモデルを例にとると，外生ショックが全く存在しなければ，効用のとりうる最大値は初期の資本ストックの大きさのみによって決まる．
[^2]: このように再帰表現できるのは，今考えている問題が無限期間の動的最適化問題だからである．この場合，価値関数 $V$ の形が時間 $t$ に依存しなくなる．有限期間の動的最適化問題の場合には，ベルマン方程式に現れる価値関数は時間にあらわに依存する．
[^3]: jump 变量的取值可以用状态变量的函数 $h(s_t)$ 来表示．
[^4]: $\text{argmax}_{x_t}$ 指的是当求最大值的时候 $x_t$ 的取值．
[^5]: その意味は，他の条件が同じならば，同じ状態が複数回起こったときには同じ行動をとるはずだということである．
[^6]: 線型近似やチェビシェフ近似など．詳しくは後述．

[^7]: 一般に，線型写像は行列で表現できる．



##  6.2　数学の準備（５）：行列











##  6.3　モデルの再帰的表現







##  6.4　方策関数の関数近似





##  6.5　最適化手法のまとめ